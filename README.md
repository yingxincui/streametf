# ETF回测工具

这是一个基于Streamlit开发的ETF回测工具，支持组合回测和定投回测功能。

## 功能特点

- **组合回测**：支持多ETF组合的历史回测，可自定义权重，并可保存/加载自定义组合（保存于`portfolios.json`）
- **定投回测**：支持ETF定投策略的回测，可设置每月定投日和金额
- **有效前沿分析**：支持多ETF的蒙特卡洛模拟，展示最优风险收益组合、最小方差组合、等权重组合，并可保存/加载前沿分析组合（保存于`frontier_portfolios.json`）
- **性能指标**：计算总收益率、年化收益率、波动率、夏普比率、最大回撤等指标
- **可视化展示**：净值曲线、相关性矩阵、年度收益率、有效前沿图等多种图表

## 项目结构

```
├── app.py          # 主应用和UI部分
├── data.py         # 数据获取相关函数
├── dca.py          # 定投回测相关函数
├── metrics.py      # 性能指标计算
├── portfolio.py    # 组合回测相关函数
├── utils.py        # 工具函数
└── requirements.txt # 依赖包列表
```

## 安装与运行

1. 安装依赖包：

```bash
pip install -r requirements.txt
```

2. 运行应用：

```bash
streamlit run app.py
```

## 使用说明

### 组合回测

1. 在左侧面板选择至少2只ETF
2. 设置各ETF的权重（总和为100%）
3. 选择回测时间范围
4. 设置初始投资金额
5. 可输入组合名称并保存，或从下拉框加载已保存组合（保存于`portfolios.json`，仅回测功能使用）
6. 点击"运行回测"按钮

### 定投回测

1. 在左侧面板选择至少1只ETF
2. 设置各ETF的权重（总和为100%）
3. 选择定投时间范围
4. 设置每月定投金额和定投日
5. 点击"运行定投回测"按钮

### 有效前沿分析

1. 在左侧面板选择至少2只ETF，或从下拉框加载已保存的前沿分析组合（保存于`frontier_portfolios.json`，仅前沿分析功能使用）
2. 选择分析时间区间、无风险利率、模拟组合数量
3. 点击"运行有效前沿分析"按钮
4. 可输入组合名称并保存当前分析参数，便于下次快速加载
5. 右侧可查看所有模拟组合详情（收益、波动率、权重等均为百分比显示）

## 数据来源

本工具使用AKShare获取ETF历史数据，数据来源为东方财富网。